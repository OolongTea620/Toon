<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.to.t1.mypage.MypageMapper">
	<select id="getList" resultType="RecentVO" parameterType="Pager" resultMap="recentResult">
		SELECT recenttoon.*,toon.toonTitle, eachep.epTitle, eachep.eachEpNum,
		member.nickname, eachep.epSumImg
		FROM recenttoon, eachep, toon, member
		WHERE toon.writerId = member.username AND eachep.toonNum =
		toon.toonNum AND recenttoon.epNum = eachep.epNum
		AND recenttoon.username ='55555555'
		ORDER BY recenttoon.viewDate DESC;

		<!-- select * from notice -->
		<!-- <include refid="searcher"></include> -->
		<!-- order by boNum desc -->
		<!-- limit #{startRow}, #{perPage} -->
		<!-- limit 시작index번호(0부터시작), 갯수 -->
	</select>
	
	<select id="getTotalCount" parameterType="Pager" resultMap="recentResult">
		SELECT count(*)
		FROM recenttoon, eachep, toon, member
		WHERE toon.writerId = member.username AND eachep.toonNum =
		toon.toonNum AND recenttoon.epNum = eachep.epNum
		AND recenttoon.username ='55555555'
		ORDER BY recenttoon.viewDate DESC;
	
	</select>
	
	<resultMap type="RecentVO" id="recentResult">
		<id property="username" column="username" />
		<result property="toonNum" column="toonNum"/>
		<result property="epNum" column="epNum"/>
		<result property="viewDate" column="viewDate"/>

		<association property="ToonVO" javaType="ToonVO" resultMap="toonResult"></association>
		<association property="EachEpVO" javaType="EachEpVO" resultMap="eachEpResult"></association>
		<association property="MemberVO" javaType="MemberVO" resultMap="memberResult"></association>
	</resultMap>

		<resultMap type="ToonVO" id="toonResult">
			<id property="toonNum" column="toonNum"/>
			<result property="toonTitle" column="toonTitle"/>
			<result property="genre" column="genre"/>
			<result property="writerID" column="writerID"/>
			<result property="toonSum" column="toonSum"/>
			<result property="totalHit" column="totalHit"/>
			<result property="toonDay" column="toonDay"/>
			<result property="state" column="state"/>
			<result property="titleImg" column="titleImg"/>
			<result property="ratingSum" column="ratingSum"/>
			<result property="ratingPerson" column="ratingPerson"/>
		</resultMap>
		
		
		<resultMap type="EachEpVO" id="eachEpResult">
			<id property="epNum" column="epNum"/>
			<result property="toonNum" column="toonNum"/>
			<result property="eachEpNum" column="eachEpNum"/>
			<result property="epSumImg" column="epSumImg"/>
			<result property="epTitle" column="epTitle"/>
			<result property="epDate" column="epDate"/>
			<result property="epContentImg" column="epContentImg"/>
			<result property="epHit" column="epHit"/>
			
		</resultMap>
		
		<resultMap type="MemberVO" id="memberResult">
			<id property="username" column="username" />
			<result property="password" column="password"/>
			<result property="name" column="name"/>
			<result property="nickname" column="nickname"/>
			<result property="phone" column="phone"/>
			<result property="email" column="email"/>
			<result property="point" column="point"/>
			
		</resultMap>
		
	

</mapper>